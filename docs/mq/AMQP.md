# AMQP

message brokers 从发布者（发布消息，也被成为生产者）接收消息，路由这些消息到消费者（处理消息）。

## 简化的 AMQP 0-9-1 模型

AMQP 0-9-1 有以下观点：消息发布到交换器（经常和办公室或者邮箱对比）。交换器使用成为绑定的规则分发消息的副本给队列。
然后 broker 发送消息到已订阅队列的消费者。或者消费从队列请求抓取/拉取消息。

![An image](./hello-arc.png)

发布者发布消息的时候，可能指定不同的消息属性（消息元数据），这些元数据可能被broker 使用。
但是，其余部分对 broker 完全不透明，仅由接收消息的应用程序使用。
由于网络不可靠或者应用处理消息可能失败，所以AMQP 0-9-1 模型有消息确认的概念。
一条消息被发送给消费者，消费者通知broker。这个过程可以是自动的，也可以由开发者选择怎样处理。
使用消息确认的时候，如果broker收到了一个确认，就会移除这条消息。（或者一组消息）。

在某些场景下，如果一个消息不能被路由，消息可能返回到发布者，丢失，如果 broker 实现了一个扩展，放入一个被称为死信队列的地方。
发布者通过发布消息时携带的某些参数选择怎样处理这种情况。

队列，交换器和绑定统称为 AMQP 实体。