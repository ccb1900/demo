<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>protobuf 基础 | 搬砖的故事</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="ico" href="/logo.png">
    <meta name="description" content="java,mysql,php,redis,消息队列,laravel,spring">
    
    <link rel="preload" href="/assets/css/0.styles.e7935bbb.css" as="style"><link rel="preload" href="/assets/js/app.d478231f.js" as="script"><link rel="preload" href="/assets/js/1.c46a2a66.js" as="script"><link rel="preload" href="/assets/js/24.d8259fdd.js" as="script"><link rel="prefetch" href="/assets/js/10.11fd4e0a.js"><link rel="prefetch" href="/assets/js/100.7afed95f.js"><link rel="prefetch" href="/assets/js/101.77ebbb80.js"><link rel="prefetch" href="/assets/js/102.2c785a1f.js"><link rel="prefetch" href="/assets/js/103.46c0e6fb.js"><link rel="prefetch" href="/assets/js/104.bb58a777.js"><link rel="prefetch" href="/assets/js/105.34639550.js"><link rel="prefetch" href="/assets/js/106.2e8f89de.js"><link rel="prefetch" href="/assets/js/107.35875e66.js"><link rel="prefetch" href="/assets/js/108.3f8d2775.js"><link rel="prefetch" href="/assets/js/109.6543f7de.js"><link rel="prefetch" href="/assets/js/11.87c4c059.js"><link rel="prefetch" href="/assets/js/110.9f338676.js"><link rel="prefetch" href="/assets/js/111.2190da9d.js"><link rel="prefetch" href="/assets/js/112.18c785b2.js"><link rel="prefetch" href="/assets/js/113.10964688.js"><link rel="prefetch" href="/assets/js/114.4c54d0c4.js"><link rel="prefetch" href="/assets/js/115.d0a0639b.js"><link rel="prefetch" href="/assets/js/116.4a66cc93.js"><link rel="prefetch" href="/assets/js/117.b5197608.js"><link rel="prefetch" href="/assets/js/118.7a84b441.js"><link rel="prefetch" href="/assets/js/119.76d4c56e.js"><link rel="prefetch" href="/assets/js/12.0266d733.js"><link rel="prefetch" href="/assets/js/120.f45bd5e9.js"><link rel="prefetch" href="/assets/js/121.566f94a9.js"><link rel="prefetch" href="/assets/js/122.b73c1555.js"><link rel="prefetch" href="/assets/js/123.3c3349d1.js"><link rel="prefetch" href="/assets/js/124.166ab78a.js"><link rel="prefetch" href="/assets/js/125.dbb52f13.js"><link rel="prefetch" href="/assets/js/126.bb5ac1ed.js"><link rel="prefetch" href="/assets/js/127.d2784685.js"><link rel="prefetch" href="/assets/js/128.27d18fa7.js"><link rel="prefetch" href="/assets/js/129.d577719b.js"><link rel="prefetch" href="/assets/js/13.85f95673.js"><link rel="prefetch" href="/assets/js/130.96b2da89.js"><link rel="prefetch" href="/assets/js/131.6311dbe5.js"><link rel="prefetch" href="/assets/js/132.ccdfae6c.js"><link rel="prefetch" href="/assets/js/133.992ab404.js"><link rel="prefetch" href="/assets/js/134.eab17e75.js"><link rel="prefetch" href="/assets/js/135.8804984c.js"><link rel="prefetch" href="/assets/js/136.0a48ff8e.js"><link rel="prefetch" href="/assets/js/137.acbccd7d.js"><link rel="prefetch" href="/assets/js/138.a1347c43.js"><link rel="prefetch" href="/assets/js/139.8f0e7ccc.js"><link rel="prefetch" href="/assets/js/14.2040b9d2.js"><link rel="prefetch" href="/assets/js/140.5361d07a.js"><link rel="prefetch" href="/assets/js/15.f5e4ff55.js"><link rel="prefetch" href="/assets/js/16.8033e3a4.js"><link rel="prefetch" href="/assets/js/17.216c21ca.js"><link rel="prefetch" href="/assets/js/18.4c7831d7.js"><link rel="prefetch" href="/assets/js/19.e162e903.js"><link rel="prefetch" href="/assets/js/20.9097cf53.js"><link rel="prefetch" href="/assets/js/21.734dfaad.js"><link rel="prefetch" href="/assets/js/22.2171f954.js"><link rel="prefetch" href="/assets/js/23.61d3951b.js"><link rel="prefetch" href="/assets/js/25.89a46142.js"><link rel="prefetch" href="/assets/js/26.acb115d0.js"><link rel="prefetch" href="/assets/js/27.344e5e9d.js"><link rel="prefetch" href="/assets/js/28.17aa72c2.js"><link rel="prefetch" href="/assets/js/29.0df15406.js"><link rel="prefetch" href="/assets/js/30.d12b6880.js"><link rel="prefetch" href="/assets/js/31.8baa6b7b.js"><link rel="prefetch" href="/assets/js/32.08f98345.js"><link rel="prefetch" href="/assets/js/33.e4570763.js"><link rel="prefetch" href="/assets/js/34.154b44f5.js"><link rel="prefetch" href="/assets/js/35.772ae6ee.js"><link rel="prefetch" href="/assets/js/36.7ac4937b.js"><link rel="prefetch" href="/assets/js/37.c6cd3e69.js"><link rel="prefetch" href="/assets/js/38.fe72c79f.js"><link rel="prefetch" href="/assets/js/39.13bd1d56.js"><link rel="prefetch" href="/assets/js/4.cbcc8d98.js"><link rel="prefetch" href="/assets/js/40.45cec5b9.js"><link rel="prefetch" href="/assets/js/41.5f529ab0.js"><link rel="prefetch" href="/assets/js/42.6b1bb8bf.js"><link rel="prefetch" href="/assets/js/43.99713635.js"><link rel="prefetch" href="/assets/js/44.3b07ae10.js"><link rel="prefetch" href="/assets/js/45.3c42df39.js"><link rel="prefetch" href="/assets/js/46.38e36ccf.js"><link rel="prefetch" href="/assets/js/47.f07183c2.js"><link rel="prefetch" href="/assets/js/48.70aa5864.js"><link rel="prefetch" href="/assets/js/49.3183d513.js"><link rel="prefetch" href="/assets/js/5.8676b9fb.js"><link rel="prefetch" href="/assets/js/50.28cef163.js"><link rel="prefetch" href="/assets/js/51.01c59fac.js"><link rel="prefetch" href="/assets/js/52.ffdb6589.js"><link rel="prefetch" href="/assets/js/53.f366e5a4.js"><link rel="prefetch" href="/assets/js/54.fad114d8.js"><link rel="prefetch" href="/assets/js/55.85adf701.js"><link rel="prefetch" href="/assets/js/56.2c5a8021.js"><link rel="prefetch" href="/assets/js/57.c4a7001c.js"><link rel="prefetch" href="/assets/js/58.26e3ab5c.js"><link rel="prefetch" href="/assets/js/59.93acb492.js"><link rel="prefetch" href="/assets/js/6.2b2b8be9.js"><link rel="prefetch" href="/assets/js/60.b8eb6776.js"><link rel="prefetch" href="/assets/js/61.feeb14d9.js"><link rel="prefetch" href="/assets/js/62.c5169a1e.js"><link rel="prefetch" href="/assets/js/63.ec2ca216.js"><link rel="prefetch" href="/assets/js/64.131866e8.js"><link rel="prefetch" href="/assets/js/65.8390b603.js"><link rel="prefetch" href="/assets/js/66.e4002f37.js"><link rel="prefetch" href="/assets/js/67.c16b42b3.js"><link rel="prefetch" href="/assets/js/68.4fc13362.js"><link rel="prefetch" href="/assets/js/69.f0b41f63.js"><link rel="prefetch" href="/assets/js/7.59e9eab6.js"><link rel="prefetch" href="/assets/js/70.6845e6c4.js"><link rel="prefetch" href="/assets/js/71.45f87c76.js"><link rel="prefetch" href="/assets/js/72.902df615.js"><link rel="prefetch" href="/assets/js/73.29ee365b.js"><link rel="prefetch" href="/assets/js/74.854e71ef.js"><link rel="prefetch" href="/assets/js/75.b9b7f821.js"><link rel="prefetch" href="/assets/js/76.445bd55e.js"><link rel="prefetch" href="/assets/js/77.6ba679ac.js"><link rel="prefetch" href="/assets/js/78.c68db6b1.js"><link rel="prefetch" href="/assets/js/79.b5bc1930.js"><link rel="prefetch" href="/assets/js/8.86e17bf9.js"><link rel="prefetch" href="/assets/js/80.a4639d15.js"><link rel="prefetch" href="/assets/js/81.92410d35.js"><link rel="prefetch" href="/assets/js/82.e812f032.js"><link rel="prefetch" href="/assets/js/83.91426d66.js"><link rel="prefetch" href="/assets/js/84.21ce1dee.js"><link rel="prefetch" href="/assets/js/85.52b63f25.js"><link rel="prefetch" href="/assets/js/86.41576466.js"><link rel="prefetch" href="/assets/js/87.3e27531c.js"><link rel="prefetch" href="/assets/js/88.d45c286d.js"><link rel="prefetch" href="/assets/js/89.194fd75a.js"><link rel="prefetch" href="/assets/js/9.a57605e2.js"><link rel="prefetch" href="/assets/js/90.29861c52.js"><link rel="prefetch" href="/assets/js/91.50102c8a.js"><link rel="prefetch" href="/assets/js/92.ad2aec6c.js"><link rel="prefetch" href="/assets/js/93.e07f039a.js"><link rel="prefetch" href="/assets/js/94.8eef8ea1.js"><link rel="prefetch" href="/assets/js/95.6fa28c36.js"><link rel="prefetch" href="/assets/js/96.f4eaa3c3.js"><link rel="prefetch" href="/assets/js/97.034235d9.js"><link rel="prefetch" href="/assets/js/98.fb15732f.js"><link rel="prefetch" href="/assets/js/99.c88449ea.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.4eede021.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e7935bbb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">搬砖的故事</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/backend/" class="nav-link router-link-active">
  后端
</a></div><div class="nav-item"><a href="/front/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/dragon/" class="nav-link">
  屠龙术
</a></div><div class="nav-item"><a href="/other/" class="nav-link">
  其他
</a></div><div class="nav-item"><a href="/recipe/" class="nav-link">
  菜谱
</a></div><div class="nav-item"><a href="/post/" class="nav-link">
  博客
</a></div><div class="nav-item"><a href="/app/" class="nav-link">
  应用
</a></div><div class="nav-item"><a href="https://github.com/ccb1900/pages" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/backend/" class="nav-link router-link-active">
  后端
</a></div><div class="nav-item"><a href="/front/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/dragon/" class="nav-link">
  屠龙术
</a></div><div class="nav-item"><a href="/other/" class="nav-link">
  其他
</a></div><div class="nav-item"><a href="/recipe/" class="nav-link">
  菜谱
</a></div><div class="nav-item"><a href="/post/" class="nav-link">
  博客
</a></div><div class="nav-item"><a href="/app/" class="nav-link">
  应用
</a></div><div class="nav-item"><a href="https://github.com/ccb1900/pages" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Golang</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/backend/golang/" aria-current="page" class="sidebar-link">golang 参考手册</a></li><li><a href="/backend/golang/单例模式.html" class="sidebar-link">golang 单例模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/backend/golang/单例模式.html#普通实现-不支持并发" class="sidebar-link">普通实现（不支持并发）</a></li><li class="sidebar-sub-header"><a href="/backend/golang/单例模式.html#加锁实现" class="sidebar-link">加锁实现</a></li><li class="sidebar-sub-header"><a href="/backend/golang/单例模式.html#sync-once-实现" class="sidebar-link">sync.once 实现</a></li></ul></li><li><a href="/backend/golang/go 语言设计与实现.html" class="sidebar-link">golang 语言设计与实现</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/backend/golang/go 语言设计与实现.html#编译原理" class="sidebar-link">编译原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/backend/golang/go 语言设计与实现.html#词法与语法分析" class="sidebar-link">词法与语法分析</a></li><li class="sidebar-sub-header"><a href="/backend/golang/go 语言设计与实现.html#类型检查和ast转换" class="sidebar-link">类型检查和AST转换</a></li><li class="sidebar-sub-header"><a href="/backend/golang/go 语言设计与实现.html#通用ssa生成" class="sidebar-link">通用SSA生成</a></li><li class="sidebar-sub-header"><a href="/backend/golang/go 语言设计与实现.html#机器代码生成" class="sidebar-link">机器代码生成</a></li></ul></li><li class="sidebar-sub-header"><a href="/backend/golang/go 语言设计与实现.html#运行时" class="sidebar-link">运行时</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/backend/golang/go 语言设计与实现.html#基础知识" class="sidebar-link">基础知识</a></li><li class="sidebar-sub-header"><a href="/backend/golang/go 语言设计与实现.html#进阶知识" class="sidebar-link">进阶知识</a></li></ul></li></ul></li><li><a href="/backend/golang/常用工具函数.html" class="sidebar-link">golang 常用工具函数</a></li><li><a href="/backend/golang/protobuf 基础.html" class="active sidebar-link">protobuf 基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#定义-message-类型" class="sidebar-link">定义 message 类型</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#标量值类型" class="sidebar-link">标量值类型</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#默认值" class="sidebar-link">默认值</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#枚举" class="sidebar-link">枚举</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#使用其他消息类型" class="sidebar-link">使用其他消息类型</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#嵌套类型" class="sidebar-link">嵌套类型</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#更新消息类型" class="sidebar-link">更新消息类型</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#未知字段" class="sidebar-link">未知字段</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#any" class="sidebar-link">any</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#oneof" class="sidebar-link">oneof</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#映射-map" class="sidebar-link">映射(map)</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#包" class="sidebar-link">包</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#定义服务" class="sidebar-link">定义服务</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#json-映射" class="sidebar-link">json 映射</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#选项" class="sidebar-link">选项</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 基础.html#生成你自己的类" class="sidebar-link">生成你自己的类</a></li></ul></li><li><a href="/backend/golang/protobuf 风格.html" class="sidebar-link">protobuf 风格</a></li><li><a href="/backend/golang/protobuf 教程.html" class="sidebar-link">protobuf 教程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 教程.html#例子" class="sidebar-link">例子</a></li></ul></li><li><a href="/backend/golang/protobuf 编码.html" class="sidebar-link">protobuf 编码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 编码.html#一个简单的消息类型" class="sidebar-link">一个简单的消息类型</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 编码.html#_128" class="sidebar-link">128</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 编码.html#消息结构" class="sidebar-link">消息结构</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 编码.html#更多值类型" class="sidebar-link">更多值类型</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 编码.html#嵌入消息" class="sidebar-link">嵌入消息</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 编码.html#可选和重复元素" class="sidebar-link">可选和重复元素</a></li><li class="sidebar-sub-header"><a href="/backend/golang/protobuf 编码.html#字段顺序" class="sidebar-link">字段顺序</a></li></ul></li><li><a href="/backend/golang/protobuf 技巧.html" class="sidebar-link">protobuf 技巧</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>PHP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Rust</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Netty</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>RabbitMQ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>RocketMQ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Kafka</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/backend/spring/" class="sidebar-heading clickable"><span>Spring</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Mybatis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Laravel</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/backend/mysql/" class="sidebar-heading clickable"><span>Mysql</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>微服务</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>容器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>翻译</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="protobuf-基础"><a href="#protobuf-基础" class="header-anchor">#</a> protobuf 基础</h1> <h2 id="定义-message-类型"><a href="#定义-message-类型" class="header-anchor">#</a> 定义 message 类型</h2> <p>我们先来定义一个搜索请求对象</p> <div class="language- extra-class"><pre class="language-text"><code>syntax = &quot;proto3&quot;;

message SearchRequest {
  string query = 1;
  int32 page_number = 2;
  int32 result_per_page = 3;
}
</code></pre></div><ul><li>第一行指定了语法的版本，如果没有该选项，默认使用版本2</li> <li>定义指定了三个字段，也就是键值对，包含名称和类型</li> <li>上面的例子中，所有的字段都是标量类型</li> <li>你也可以为字段指定组合类型，包括枚举类型和其他类型</li> <li>消息中的每个字段都有一个唯一的数字，这些数字是用来在消息二进制格式中标识字段的。如果消息类型已经投入使用就不要再更改这个数字。</li> <li>数字1-15花费一个字节编码，包括数字和字段类型</li> <li>数字16到2047使用两个字节</li> <li>频繁使用的字段最好用1-15，为未来可能添加的频繁使用的字段留出数字。</li> <li>数字最小是1，最大是2的29次方减去1或者 536870911，19000-19999属于保留数字。</li> <li>默认是0或1个，repeated 是大于1（数组吧，列表）</li> <li>一个proto文件可以有多个消息类型</li> <li>支持行注释和块注释</li></ul> <div class="language- extra-class"><pre class="language-text"><code>message Foo {
  reserved 2, 15, 9 to 11;
  reserved &quot;foo&quot;, &quot;bar&quot;;
}
</code></pre></div><ul><li>标注为保留字段</li> <li>数字和名称要分别标注</li></ul> <h2 id="标量值类型"><a href="#标量值类型" class="header-anchor">#</a> 标量值类型</h2> <p>double，float，int32等</p> <p>https://developers.google.com/protocol-buffers/docs/proto3#scalar</p> <h2 id="默认值"><a href="#默认值" class="header-anchor">#</a> 默认值</h2> <ul><li>字符串是空字符串</li> <li>字节是空字节</li> <li>布尔是false</li> <li>数字是0</li> <li>枚举是第一个被定义的枚举值，必须是0</li> <li>消息字段依赖于特定的语言</li> <li>repeated字段是空，一般是个空列表，这个看语言</li></ul> <h2 id="枚举"><a href="#枚举" class="header-anchor">#</a> 枚举</h2> <p>当你定义一个消息类型，你可能想要某些字段的值是预定义值列表的一个。</p> <div class="language- extra-class"><pre class="language-text"><code>enum Corpus {
  UNIVERSAL = 0;// 第一个必须是0
  WEB  = 1;
  IMAGES  = 2;
  LOCAL  = 3;
  NEWS  = 4;
  PRODUCTS  = 5;
  VIDEO  = 6;
}

message Test {
  enum Gender {
    M = 0;
    F = 2;
  }
  Gender gender = 8;
}
</code></pre></div><h2 id="使用其他消息类型"><a href="#使用其他消息类型" class="header-anchor">#</a> 使用其他消息类型</h2> <h2 id="嵌套类型"><a href="#嵌套类型" class="header-anchor">#</a> 嵌套类型</h2> <h2 id="更新消息类型"><a href="#更新消息类型" class="header-anchor">#</a> 更新消息类型</h2> <h2 id="未知字段"><a href="#未知字段" class="header-anchor">#</a> 未知字段</h2> <h2 id="any"><a href="#any" class="header-anchor">#</a> any</h2> <h2 id="oneof"><a href="#oneof" class="header-anchor">#</a> oneof</h2> <h2 id="映射-map"><a href="#映射-map" class="header-anchor">#</a> 映射(map)</h2> <p>主要是讲map类型如何定义，map类型不能用repeated修饰</p> <div class="language- extra-class"><pre class="language-text"><code>map&lt;string, Project&gt; projects = 3;
</code></pre></div><p>兼容性，map 就相当于下面的写法，因此可以保障兼容性</p> <div class="language- extra-class"><pre class="language-text"><code>message MapFieldEntry {
  key_type key = 1;
  value_type value = 2;
}

repeated MapFieldEntry map_field = N;
</code></pre></div><h2 id="包"><a href="#包" class="header-anchor">#</a> 包</h2> <h2 id="定义服务"><a href="#定义服务" class="header-anchor">#</a> 定义服务</h2> <h2 id="json-映射"><a href="#json-映射" class="header-anchor">#</a> json 映射</h2> <h2 id="选项"><a href="#选项" class="header-anchor">#</a> 选项</h2> <h2 id="生成你自己的类"><a href="#生成你自己的类" class="header-anchor">#</a> 生成你自己的类</h2> <p>对命令参数进行了简单的介绍。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最近更新时间:</span> <span class="time">6/26/2021, 3:02:30 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/backend/golang/常用工具函数.html" class="prev">
        golang 常用工具函数
      </a></span> <span class="next"><a href="/backend/golang/protobuf 风格.html">
        protobuf 风格
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d478231f.js" defer></script><script src="/assets/js/1.c46a2a66.js" defer></script><script src="/assets/js/24.d8259fdd.js" defer></script>
  </body>
</html>
